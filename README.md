# LightFlow Tensorflow implementation
Implementation of Optical Flow predictions using deep learning **LightFlow** architecture proposed in **[Towards High Performance Video Object Detection for Mobiles](https://arxiv.org/pdf/1804.05830.pdf)**

## Network Variables


``` bash
Parameters:
name = LightFlow/encoder/conv1_dw/depthwise_conv/depthwise_weights:0 shape = (3, 3, 6, 1)
name = LightFlow/encoder/conv1_dw/depthwise_conv/biases:0      shape = (6,)
name = LightFlow/encoder/conv1_dw/depthwise_conv/batch_normalization/gamma:0 shape = (6,)
name = LightFlow/encoder/conv1_dw/depthwise_conv/batch_normalization/beta:0 shape = (6,)
name = LightFlow/encoder/conv1_dw/depthwise_conv/batch_normalization/moving_mean:0 shape = (6,)
name = LightFlow/encoder/conv1_dw/depthwise_conv/batch_normalization/moving_variance:0 shape = (6,)
name = LightFlow/encoder/conv1/pointwise_conv/weights:0        shape = (1, 1, 6, 32)
name = LightFlow/encoder/conv1/pointwise_conv/biases:0         shape = (32,)
name = LightFlow/encoder/conv1/pointwise_conv/batch_normalization/gamma:0 shape = (32,)
name = LightFlow/encoder/conv1/pointwise_conv/batch_normalization/beta:0 shape = (32,)
name = LightFlow/encoder/conv1/pointwise_conv/batch_normalization/moving_mean:0 shape = (32,)
name = LightFlow/encoder/conv1/pointwise_conv/batch_normalization/moving_variance:0 shape = (32,)
name = LightFlow/encoder/conv2_dw/depthwise_conv/depthwise_weights:0 shape = (3, 3, 32, 1)
name = LightFlow/encoder/conv2_dw/depthwise_conv/biases:0      shape = (32,)
name = LightFlow/encoder/conv2_dw/depthwise_conv/batch_normalization/gamma:0 shape = (32,)
name = LightFlow/encoder/conv2_dw/depthwise_conv/batch_normalization/beta:0 shape = (32,)
name = LightFlow/encoder/conv2_dw/depthwise_conv/batch_normalization/moving_mean:0 shape = (32,)
name = LightFlow/encoder/conv2_dw/depthwise_conv/batch_normalization/moving_variance:0 shape = (32,)
name = LightFlow/encoder/conv2/pointwise_conv/weights:0        shape = (1, 1, 32, 64)
name = LightFlow/encoder/conv2/pointwise_conv/biases:0         shape = (64,)
name = LightFlow/encoder/conv2/pointwise_conv/batch_normalization/gamma:0 shape = (64,)
name = LightFlow/encoder/conv2/pointwise_conv/batch_normalization/beta:0 shape = (64,)
name = LightFlow/encoder/conv2/pointwise_conv/batch_normalization/moving_mean:0 shape = (64,)
name = LightFlow/encoder/conv2/pointwise_conv/batch_normalization/moving_variance:0 shape = (64,)
name = LightFlow/encoder/conv3_dw/depthwise_conv/depthwise_weights:0 shape = (3, 3, 64, 1)
name = LightFlow/encoder/conv3_dw/depthwise_conv/biases:0      shape = (64,)
name = LightFlow/encoder/conv3_dw/depthwise_conv/batch_normalization/gamma:0 shape = (64,)
name = LightFlow/encoder/conv3_dw/depthwise_conv/batch_normalization/beta:0 shape = (64,)
name = LightFlow/encoder/conv3_dw/depthwise_conv/batch_normalization/moving_mean:0 shape = (64,)
name = LightFlow/encoder/conv3_dw/depthwise_conv/batch_normalization/moving_variance:0 shape = (64,)
name = LightFlow/encoder/conv3/pointwise_conv/weights:0        shape = (1, 1, 64, 128)
name = LightFlow/encoder/conv3/pointwise_conv/biases:0         shape = (128,)
name = LightFlow/encoder/conv3/pointwise_conv/batch_normalization/gamma:0 shape = (128,)
name = LightFlow/encoder/conv3/pointwise_conv/batch_normalization/beta:0 shape = (128,)
name = LightFlow/encoder/conv3/pointwise_conv/batch_normalization/moving_mean:0 shape = (128,)
name = LightFlow/encoder/conv3/pointwise_conv/batch_normalization/moving_variance:0 shape = (128,)
name = LightFlow/encoder/conv4a_dw/depthwise_conv/depthwise_weights:0 shape = (3, 3, 128, 1)
name = LightFlow/encoder/conv4a_dw/depthwise_conv/biases:0     shape = (128,)
name = LightFlow/encoder/conv4a_dw/depthwise_conv/batch_normalization/gamma:0 shape = (128,)
name = LightFlow/encoder/conv4a_dw/depthwise_conv/batch_normalization/beta:0 shape = (128,)
name = LightFlow/encoder/conv4a_dw/depthwise_conv/batch_normalization/moving_mean:0 shape = (128,)
name = LightFlow/encoder/conv4a_dw/depthwise_conv/batch_normalization/moving_variance:0 shape = (128,)
name = LightFlow/encoder/conv4a/pointwise_conv/weights:0       shape = (1, 1, 128, 256)
name = LightFlow/encoder/conv4a/pointwise_conv/biases:0        shape = (256,)
name = LightFlow/encoder/conv4a/pointwise_conv/batch_normalization/gamma:0 shape = (256,)
name = LightFlow/encoder/conv4a/pointwise_conv/batch_normalization/beta:0 shape = (256,)
name = LightFlow/encoder/conv4a/pointwise_conv/batch_normalization/moving_mean:0 shape = (256,)
name = LightFlow/encoder/conv4a/pointwise_conv/batch_normalization/moving_variance:0 shape = (256,)
name = LightFlow/encoder/conv4b_dw/depthwise_conv/depthwise_weights:0 shape = (3, 3, 256, 1)
name = LightFlow/encoder/conv4b_dw/depthwise_conv/biases:0     shape = (256,)
name = LightFlow/encoder/conv4b_dw/depthwise_conv/batch_normalization/gamma:0 shape = (256,)
name = LightFlow/encoder/conv4b_dw/depthwise_conv/batch_normalization/beta:0 shape = (256,)
name = LightFlow/encoder/conv4b_dw/depthwise_conv/batch_normalization/moving_mean:0 shape = (256,)
name = LightFlow/encoder/conv4b_dw/depthwise_conv/batch_normalization/moving_variance:0 shape = (256,)
name = LightFlow/encoder/conv4b/pointwise_conv/weights:0       shape = (1, 1, 256, 256)
name = LightFlow/encoder/conv4b/pointwise_conv/biases:0        shape = (256,)
name = LightFlow/encoder/conv4b/pointwise_conv/batch_normalization/gamma:0 shape = (256,)
name = LightFlow/encoder/conv4b/pointwise_conv/batch_normalization/beta:0 shape = (256,)
name = LightFlow/encoder/conv4b/pointwise_conv/batch_normalization/moving_mean:0 shape = (256,)
name = LightFlow/encoder/conv4b/pointwise_conv/batch_normalization/moving_variance:0 shape = (256,)
name = LightFlow/encoder/conv5a_dw/depthwise_conv/depthwise_weights:0 shape = (3, 3, 256, 1)
name = LightFlow/encoder/conv5a_dw/depthwise_conv/biases:0     shape = (256,)
name = LightFlow/encoder/conv5a_dw/depthwise_conv/batch_normalization/gamma:0 shape = (256,)
name = LightFlow/encoder/conv5a_dw/depthwise_conv/batch_normalization/beta:0 shape = (256,)
name = LightFlow/encoder/conv5a_dw/depthwise_conv/batch_normalization/moving_mean:0 shape = (256,)
name = LightFlow/encoder/conv5a_dw/depthwise_conv/batch_normalization/moving_variance:0 shape = (256,)
name = LightFlow/encoder/conv5a/pointwise_conv/weights:0       shape = (1, 1, 256, 512)
name = LightFlow/encoder/conv5a/pointwise_conv/biases:0        shape = (512,)
name = LightFlow/encoder/conv5a/pointwise_conv/batch_normalization/gamma:0 shape = (512,)
name = LightFlow/encoder/conv5a/pointwise_conv/batch_normalization/beta:0 shape = (512,)
name = LightFlow/encoder/conv5a/pointwise_conv/batch_normalization/moving_mean:0 shape = (512,)
name = LightFlow/encoder/conv5a/pointwise_conv/batch_normalization/moving_variance:0 shape = (512,)
name = LightFlow/encoder/conv5b_dw/depthwise_conv/depthwise_weights:0 shape = (3, 3, 512, 1)
name = LightFlow/encoder/conv5b_dw/depthwise_conv/biases:0     shape = (512,)
name = LightFlow/encoder/conv5b_dw/depthwise_conv/batch_normalization/gamma:0 shape = (512,)
name = LightFlow/encoder/conv5b_dw/depthwise_conv/batch_normalization/beta:0 shape = (512,)
name = LightFlow/encoder/conv5b_dw/depthwise_conv/batch_normalization/moving_mean:0 shape = (512,)
name = LightFlow/encoder/conv5b_dw/depthwise_conv/batch_normalization/moving_variance:0 shape = (512,)
name = LightFlow/encoder/conv5b/pointwise_conv/weights:0       shape = (1, 1, 512, 512)
name = LightFlow/encoder/conv5b/pointwise_conv/biases:0        shape = (512,)
name = LightFlow/encoder/conv5b/pointwise_conv/batch_normalization/gamma:0 shape = (512,)
name = LightFlow/encoder/conv5b/pointwise_conv/batch_normalization/beta:0 shape = (512,)
name = LightFlow/encoder/conv5b/pointwise_conv/batch_normalization/moving_mean:0 shape = (512,)
name = LightFlow/encoder/conv5b/pointwise_conv/batch_normalization/moving_variance:0 shape = (512,)
name = LightFlow/encoder/conv6a_dw/depthwise_conv/depthwise_weights:0 shape = (3, 3, 512, 1)
name = LightFlow/encoder/conv6a_dw/depthwise_conv/biases:0     shape = (512,)
name = LightFlow/encoder/conv6a_dw/depthwise_conv/batch_normalization/gamma:0 shape = (512,)
name = LightFlow/encoder/conv6a_dw/depthwise_conv/batch_normalization/beta:0 shape = (512,)
name = LightFlow/encoder/conv6a_dw/depthwise_conv/batch_normalization/moving_mean:0 shape = (512,)
name = LightFlow/encoder/conv6a_dw/depthwise_conv/batch_normalization/moving_variance:0 shape = (512,)
name = LightFlow/encoder/conv6a/pointwise_conv/weights:0       shape = (1, 1, 512, 1024)
name = LightFlow/encoder/conv6a/pointwise_conv/biases:0        shape = (1024,)
name = LightFlow/encoder/conv6a/pointwise_conv/batch_normalization/gamma:0 shape = (1024,)
name = LightFlow/encoder/conv6a/pointwise_conv/batch_normalization/beta:0 shape = (1024,)
name = LightFlow/encoder/conv6a/pointwise_conv/batch_normalization/moving_mean:0 shape = (1024,)
name = LightFlow/encoder/conv6a/pointwise_conv/batch_normalization/moving_variance:0 shape = (1024,)
name = LightFlow/encoder/conv6b_dw/depthwise_conv/depthwise_weights:0 shape = (3, 3, 1024, 1)
name = LightFlow/encoder/conv6b_dw/depthwise_conv/biases:0     shape = (1024,)
name = LightFlow/encoder/conv6b_dw/depthwise_conv/batch_normalization/gamma:0 shape = (1024,)
name = LightFlow/encoder/conv6b_dw/depthwise_conv/batch_normalization/beta:0 shape = (1024,)
name = LightFlow/encoder/conv6b_dw/depthwise_conv/batch_normalization/moving_mean:0 shape = (1024,)
name = LightFlow/encoder/conv6b_dw/depthwise_conv/batch_normalization/moving_variance:0 shape = (1024,)
name = LightFlow/encoder/conv6b/pointwise_conv/weights:0       shape = (1, 1, 1024, 1024)
name = LightFlow/encoder/conv6b/pointwise_conv/biases:0        shape = (1024,)
name = LightFlow/encoder/conv6b/pointwise_conv/batch_normalization/gamma:0 shape = (1024,)
name = LightFlow/encoder/conv6b/pointwise_conv/batch_normalization/beta:0 shape = (1024,)
name = LightFlow/encoder/conv6b/pointwise_conv/batch_normalization/moving_mean:0 shape = (1024,)
name = LightFlow/encoder/conv6b/pointwise_conv/batch_normalization/moving_variance:0 shape = (1024,)
name = LightFlow/decoder/conv7_dw/depthwise_conv/depthwise_weights:0 shape = (3, 3, 1024, 1)
name = LightFlow/decoder/conv7_dw/depthwise_conv/biases:0      shape = (1024,)
name = LightFlow/decoder/conv7_dw/depthwise_conv/batch_normalization/gamma:0 shape = (1024,)
name = LightFlow/decoder/conv7_dw/depthwise_conv/batch_normalization/beta:0 shape = (1024,)
name = LightFlow/decoder/conv7_dw/depthwise_conv/batch_normalization/moving_mean:0 shape = (1024,)
name = LightFlow/decoder/conv7_dw/depthwise_conv/batch_normalization/moving_variance:0 shape = (1024,)
name = LightFlow/decoder/conv7/pointwise_conv/weights:0        shape = (1, 1, 1024, 256)
name = LightFlow/decoder/conv7/pointwise_conv/biases:0         shape = (256,)
name = LightFlow/decoder/conv7/pointwise_conv/batch_normalization/gamma:0 shape = (256,)
name = LightFlow/decoder/conv7/pointwise_conv/batch_normalization/beta:0 shape = (256,)
name = LightFlow/decoder/conv7/pointwise_conv/batch_normalization/moving_mean:0 shape = (256,)
name = LightFlow/decoder/conv7/pointwise_conv/batch_normalization/moving_variance:0 shape = (256,)
name = LightFlow/decoder/conv8_dw/depthwise_conv/depthwise_weights:0 shape = (3, 3, 768, 1)
name = LightFlow/decoder/conv8_dw/depthwise_conv/biases:0      shape = (768,)
name = LightFlow/decoder/conv8_dw/depthwise_conv/batch_normalization/gamma:0 shape = (768,)
name = LightFlow/decoder/conv8_dw/depthwise_conv/batch_normalization/beta:0 shape = (768,)
name = LightFlow/decoder/conv8_dw/depthwise_conv/batch_normalization/moving_mean:0 shape = (768,)
name = LightFlow/decoder/conv8_dw/depthwise_conv/batch_normalization/moving_variance:0 shape = (768,)
name = LightFlow/decoder/conv8/pointwise_conv/weights:0        shape = (1, 1, 768, 128)
name = LightFlow/decoder/conv8/pointwise_conv/biases:0         shape = (128,)
name = LightFlow/decoder/conv8/pointwise_conv/batch_normalization/gamma:0 shape = (128,)
name = LightFlow/decoder/conv8/pointwise_conv/batch_normalization/beta:0 shape = (128,)
name = LightFlow/decoder/conv8/pointwise_conv/batch_normalization/moving_mean:0 shape = (128,)
name = LightFlow/decoder/conv8/pointwise_conv/batch_normalization/moving_variance:0 shape = (128,)
name = LightFlow/decoder/conv9_dw/depthwise_conv/depthwise_weights:0 shape = (3, 3, 384, 1)
name = LightFlow/decoder/conv9_dw/depthwise_conv/biases:0      shape = (384,)
name = LightFlow/decoder/conv9_dw/depthwise_conv/batch_normalization/gamma:0 shape = (384,)
name = LightFlow/decoder/conv9_dw/depthwise_conv/batch_normalization/beta:0 shape = (384,)
name = LightFlow/decoder/conv9_dw/depthwise_conv/batch_normalization/moving_mean:0 shape = (384,)
name = LightFlow/decoder/conv9_dw/depthwise_conv/batch_normalization/moving_variance:0 shape = (384,)
name = LightFlow/decoder/conv9/pointwise_conv/weights:0        shape = (1, 1, 384, 64)
name = LightFlow/decoder/conv9/pointwise_conv/biases:0         shape = (64,)
name = LightFlow/decoder/conv9/pointwise_conv/batch_normalization/gamma:0 shape = (64,)
name = LightFlow/decoder/conv9/pointwise_conv/batch_normalization/beta:0 shape = (64,)
name = LightFlow/decoder/conv9/pointwise_conv/batch_normalization/moving_mean:0 shape = (64,)
name = LightFlow/decoder/conv9/pointwise_conv/batch_normalization/moving_variance:0 shape = (64,)
name = LightFlow/decoder/conv10_dw/depthwise_conv/depthwise_weights:0 shape = (3, 3, 192, 1)
name = LightFlow/decoder/conv10_dw/depthwise_conv/biases:0     shape = (192,)
name = LightFlow/decoder/conv10_dw/depthwise_conv/batch_normalization/gamma:0 shape = (192,)
name = LightFlow/decoder/conv10_dw/depthwise_conv/batch_normalization/beta:0 shape = (192,)
name = LightFlow/decoder/conv10_dw/depthwise_conv/batch_normalization/moving_mean:0 shape = (192,)
name = LightFlow/decoder/conv10_dw/depthwise_conv/batch_normalization/moving_variance:0 shape = (192,)
name = LightFlow/decoder/conv10/pointwise_conv/weights:0       shape = (1, 1, 192, 32)
name = LightFlow/decoder/conv10/pointwise_conv/biases:0        shape = (32,)
name = LightFlow/decoder/conv10/pointwise_conv/batch_normalization/gamma:0 shape = (32,)
name = LightFlow/decoder/conv10/pointwise_conv/batch_normalization/beta:0 shape = (32,)
name = LightFlow/decoder/conv10/pointwise_conv/batch_normalization/moving_mean:0 shape = (32,)
name = LightFlow/decoder/conv10/pointwise_conv/batch_normalization/moving_variance:0 shape = (32,)
name = LightFlow/decoder/conv11_dw/depthwise_conv/depthwise_weights:0 shape = (3, 3, 96, 1)
name = LightFlow/decoder/conv11_dw/depthwise_conv/biases:0     shape = (96,)
name = LightFlow/decoder/conv11_dw/depthwise_conv/batch_normalization/gamma:0 shape = (96,)
name = LightFlow/decoder/conv11_dw/depthwise_conv/batch_normalization/beta:0 shape = (96,)
name = LightFlow/decoder/conv11_dw/depthwise_conv/batch_normalization/moving_mean:0 shape = (96,)
name = LightFlow/decoder/conv11_dw/depthwise_conv/batch_normalization/moving_variance:0 shape = (96,)
name = LightFlow/decoder/conv11/pointwise_conv/weights:0       shape = (1, 1, 96, 16)
name = LightFlow/decoder/conv11/pointwise_conv/biases:0        shape = (16,)
name = LightFlow/decoder/conv11/pointwise_conv/batch_normalization/gamma:0 shape = (16,)
name = LightFlow/decoder/conv11/pointwise_conv/batch_normalization/beta:0 shape = (16,)
name = LightFlow/decoder/conv11/pointwise_conv/batch_normalization/moving_mean:0 shape = (16,)
name = LightFlow/decoder/conv11/pointwise_conv/batch_normalization/moving_variance:0 shape = (16,)
name = LightFlow/optical_flow_pred/conv12_dw/depthwise_conv/depthwise_weights:0 shape = (3, 3, 256, 1)
name = LightFlow/optical_flow_pred/conv12_dw/depthwise_conv/biases:0 shape = (256,)
name = LightFlow/optical_flow_pred/conv12_dw/depthwise_conv/batch_normalization/gamma:0 shape = (256,)
name = LightFlow/optical_flow_pred/conv12_dw/depthwise_conv/batch_normalization/beta:0 shape = (256,)
name = LightFlow/optical_flow_pred/conv12_dw/depthwise_conv/batch_normalization/moving_mean:0 shape = (256,)
name = LightFlow/optical_flow_pred/conv12_dw/depthwise_conv/batch_normalization/moving_variance:0 shape = (256,)
name = LightFlow/optical_flow_pred/conv12/pointwise_conv/weights:0 shape = (1, 1, 256, 2)
name = LightFlow/optical_flow_pred/conv12/pointwise_conv/biases:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv12/pointwise_conv/batch_normalization/gamma:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv12/pointwise_conv/batch_normalization/beta:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv12/pointwise_conv/batch_normalization/moving_mean:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv12/pointwise_conv/batch_normalization/moving_variance:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv13_dw/depthwise_conv/depthwise_weights:0 shape = (3, 3, 128, 1)
name = LightFlow/optical_flow_pred/conv13_dw/depthwise_conv/biases:0 shape = (128,)
name = LightFlow/optical_flow_pred/conv13_dw/depthwise_conv/batch_normalization/gamma:0 shape = (128,)
name = LightFlow/optical_flow_pred/conv13_dw/depthwise_conv/batch_normalization/beta:0 shape = (128,)
name = LightFlow/optical_flow_pred/conv13_dw/depthwise_conv/batch_normalization/moving_mean:0 shape = (128,)
name = LightFlow/optical_flow_pred/conv13_dw/depthwise_conv/batch_normalization/moving_variance:0 shape = (128,)
name = LightFlow/optical_flow_pred/conv13/pointwise_conv/weights:0 shape = (1, 1, 128, 2)
name = LightFlow/optical_flow_pred/conv13/pointwise_conv/biases:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv13/pointwise_conv/batch_normalization/gamma:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv13/pointwise_conv/batch_normalization/beta:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv13/pointwise_conv/batch_normalization/moving_mean:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv13/pointwise_conv/batch_normalization/moving_variance:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv14_dw/depthwise_conv/depthwise_weights:0 shape = (3, 3, 64, 1)
name = LightFlow/optical_flow_pred/conv14_dw/depthwise_conv/biases:0 shape = (64,)
name = LightFlow/optical_flow_pred/conv14_dw/depthwise_conv/batch_normalization/gamma:0 shape = (64,)
name = LightFlow/optical_flow_pred/conv14_dw/depthwise_conv/batch_normalization/beta:0 shape = (64,)
name = LightFlow/optical_flow_pred/conv14_dw/depthwise_conv/batch_normalization/moving_mean:0 shape = (64,)
name = LightFlow/optical_flow_pred/conv14_dw/depthwise_conv/batch_normalization/moving_variance:0 shape = (64,)
name = LightFlow/optical_flow_pred/conv14/pointwise_conv/weights:0 shape = (1, 1, 64, 2)
name = LightFlow/optical_flow_pred/conv14/pointwise_conv/biases:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv14/pointwise_conv/batch_normalization/gamma:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv14/pointwise_conv/batch_normalization/beta:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv14/pointwise_conv/batch_normalization/moving_mean:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv14/pointwise_conv/batch_normalization/moving_variance:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv15_dw/depthwise_conv/depthwise_weights:0 shape = (3, 3, 32, 1)
name = LightFlow/optical_flow_pred/conv15_dw/depthwise_conv/biases:0 shape = (32,)
name = LightFlow/optical_flow_pred/conv15_dw/depthwise_conv/batch_normalization/gamma:0 shape = (32,)
name = LightFlow/optical_flow_pred/conv15_dw/depthwise_conv/batch_normalization/beta:0 shape = (32,)
name = LightFlow/optical_flow_pred/conv15_dw/depthwise_conv/batch_normalization/moving_mean:0 shape = (32,)
name = LightFlow/optical_flow_pred/conv15_dw/depthwise_conv/batch_normalization/moving_variance:0 shape = (32,)
name = LightFlow/optical_flow_pred/conv15/pointwise_conv/weights:0 shape = (1, 1, 32, 2)
name = LightFlow/optical_flow_pred/conv15/pointwise_conv/biases:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv15/pointwise_conv/batch_normalization/gamma:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv15/pointwise_conv/batch_normalization/beta:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv15/pointwise_conv/batch_normalization/moving_mean:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv15/pointwise_conv/batch_normalization/moving_variance:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv16_dw/depthwise_conv/depthwise_weights:0 shape = (3, 3, 16, 1)
name = LightFlow/optical_flow_pred/conv16_dw/depthwise_conv/biases:0 shape = (16,)
name = LightFlow/optical_flow_pred/conv16_dw/depthwise_conv/batch_normalization/gamma:0 shape = (16,)
name = LightFlow/optical_flow_pred/conv16_dw/depthwise_conv/batch_normalization/beta:0 shape = (16,)
name = LightFlow/optical_flow_pred/conv16_dw/depthwise_conv/batch_normalization/moving_mean:0 shape = (16,)
name = LightFlow/optical_flow_pred/conv16_dw/depthwise_conv/batch_normalization/moving_variance:0 shape = (16,)
name = LightFlow/optical_flow_pred/conv16/pointwise_conv/weights:0 shape = (1, 1, 16, 2)
name = LightFlow/optical_flow_pred/conv16/pointwise_conv/biases:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv16/pointwise_conv/batch_normalization/gamma:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv16/pointwise_conv/batch_normalization/beta:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv16/pointwise_conv/batch_normalization/moving_mean:0 shape = (2,)
name = LightFlow/optical_flow_pred/conv16/pointwise_conv/batch_normalization/moving_variance:0 shape = (2,)

Inputs/Outputs:
name = inputs:0                                                shape = (?, 384, 512, 6)
name = LightFlow/optical_flow_pred/average_layer/truediv:0     shape = (?, 96, 128, 2)

```
The main training procedure is based on **https://github.com/sampepose/flownet2-tf** , and the network was builded using Keras.

## Tensorbaord logs
![lightflow tensorboard Loss](/outputs/tensorboard.png?raw=true)
![lightflow tensorboard Val image](/outputs/output_val.png?raw=true)

### Actual input/output
![inputs](/data/samples/0img0.ppm?raw=true)
![inputs](/data/samples/0img1.ppm?raw=true)

![lightflow Actual output](/outputs/output.png?raw=true)


# TODOs
* Fix error with the BatchNorm layer in Keras, model does not converge.
* Migrate Keras model definition to TensorFlow
* Work in progress
# Reference article, thanks

* **https://github.com/sampepose/flownet2-tf**
* **https://arxiv.org/pdf/1804.05830.pdf**
* **https://github.com/tensorflow/models/blob/master/research/slim/nets/mobilenet_v1.py**